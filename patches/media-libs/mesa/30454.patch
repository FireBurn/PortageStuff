From 8803d9cec94e79bd28b252c5a9205e24e8ab3edf Mon Sep 17 00:00:00 2001
From: Mike Blumenkrantz <michael.blumenkrantz@gmail.com>
Date: Wed, 31 Jul 2024 17:31:14 -0400
Subject: [PATCH] dri: add kopper stubs to avoid build failures

Fixes: 62847d14b55 ("glx: delete DRI_KOPPER")

Reviewed-by: Ian Romanick <ian.d.romanick@intel.com>
Part-of: <https://gitlab.freedesktop.org/mesa/mesa/-/merge_requests/30454>
---
 src/gallium/frontends/dri/dri_util.c | 35 ++++++++++++++++++++++++++++
 1 file changed, 35 insertions(+)

diff --git a/src/gallium/frontends/dri/dri_util.c b/src/gallium/frontends/dri/dri_util.c
index 733f12641b4cf..5530f0e50ff20 100644
--- a/src/gallium/frontends/dri/dri_util.c
+++ b/src/gallium/frontends/dri/dri_util.c
@@ -850,6 +850,41 @@ driGetAPIMask(__DRIscreen *screen)
     return dri_screen(screen)->api_mask;
 }
 
+/* stubs to avoid build failure */
+#ifndef GALLIUM_ZINK
+int64_t
+kopperSwapBuffers(__DRIdrawable *dPriv, uint32_t flush_flags)
+{
+   return 0;
+}
+
+int64_t
+kopperSwapBuffersWithDamage(__DRIdrawable *dPriv, uint32_t flush_flags, int nrects, const int *rects)
+{
+   return 0;
+}
+
+__DRIdrawable *
+kopperCreateNewDrawable(__DRIscreen *psp,
+                        const __DRIconfig *config,
+                        void *data,
+                        __DRIkopperDrawableInfo *info)
+{
+   return NULL;
+}
+
+void
+kopperSetSwapInterval(__DRIdrawable *dPriv, int interval)
+{
+}
+
+int
+kopperQueryBufferAge(__DRIdrawable *dPriv)
+{
+   return 0;
+}
+#endif
+
 /**
  * swrast swapbuffers entrypoint.
  *
-- 
GitLab

