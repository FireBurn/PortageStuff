From 4ff647c2ce911653577eb2dd5794946afb1bff2e Mon Sep 17 00:00:00 2001
From: Mike Lothian <mike@fireburn.co.uk>
Date: Thu, 3 Feb 2022 15:31:58 +0000
Subject: [PATCH] Revert "StatJob: cancel job if url is invalid"

This reverts commit 6edec1f4907bae55684f61d38edd5376265ce538.
---
 src/core/statjob.cpp | 22 +---------------------
 1 file changed, 1 insertion(+), 21 deletions(-)

diff --git a/src/core/statjob.cpp b/src/core/statjob.cpp
index ffbdfe7aa..bdbcab01d 100644
--- a/src/core/statjob.cpp
+++ b/src/core/statjob.cpp
@@ -217,30 +217,10 @@ StatJob *KIO::stat(const QUrl &url, JobFlags flags)
     return statDetails(url, StatJob::SourceSide, KIO::StatDefaultDetails, flags);
 }
 
-static bool isUrlValid(const QUrl &url)
-{
-    if (!url.isValid()) {
-        qCWarning(KIO_CORE) << "Invalid url:" << url << ", cancelling job.";
-        return false;
-    }
-
-    if (url.isLocalFile()) {
-        qCWarning(KIO_CORE) << "Url" << url << "already represents a local file, cancelling job.";
-        return false;
-    }
-
-    if (KProtocolInfo::protocolClass(url.scheme()) != QLatin1String(":local")) {
-        qCWarning(KIO_CORE) << "Protocol Class of url" << url << ", isn't ':local', cancelling job.";
-        return false;
-    }
-
-    return true;
-}
-
 StatJob *KIO::mostLocalUrl(const QUrl &url, JobFlags flags)
 {
     StatJob *job = statDetails(url, StatJob::SourceSide, KIO::StatDefaultDetails, flags);
-    if (!isUrlValid(url)) {
+    if (url.isLocalFile() || KProtocolInfo::protocolClass(url.scheme()) != QLatin1String(":local")) {
         QTimer::singleShot(0, job, &StatJob::slotFinished);
         Scheduler::cancelJob(job); // deletes the slave if not 0
     }
-- 
2.35.1

